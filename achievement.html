<!-- 渠道管理 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>业绩</title>

    <link href="./css/reset.css" rel="stylesheet" />
    <link href="./css/vuetify.min.css" rel="stylesheet" />
    <link href="./css/css.css" rel="stylesheet" />
    <link href="./css/common.css" rel="stylesheet" />

    <style>
        .date-container>div {
            display: inline-block;
        }

        /* .sub-container {
            padding-left: 40px;
        } */

        .sub-item-sp {
            padding: 3px;
            border: 1px solid #e3e3e3;
        }

        .sub-item {
            margin-bottom: 10px;
        }

        .line {
            height: 1px;
            background-color: #e3e3e3;
            padding: 0 !important;
            margin: 10px 0;
        }

        .sp-color {
            color: #4CAF50;
        }

        .sp-color svg {
            transform: rotate(-90deg);
            background: yellowgreen;
            border-radius: 50%;
            margin-bottom: -6px;
            margin-right: 3px;
        }

        .sp-color svg circle {
            fill: yellowgreen;
        }

        .item-arrow {
            margin-left: -12px;
            margin-bottom: -4px;
        }
    </style>

</head>

<body>
    <div id="app">
        <v-app>
            <div class="header">
                <v-toolbar>
                    <v-toolbar-side-icon></v-toolbar-side-icon>
                    <v-toolbar-title>业绩</v-toolbar-title>
                    <v-spacer></v-spacer>

                    <!-- TODO -->
                    <v-toolbar-items class="hidden-sm-and-down">
                        <v-btn flat>注册</v-btn>
                        <v-btn flat>联系方式</v-btn>
                    </v-toolbar-items>
                </v-toolbar>
            </div>


            <v-container class="body" grid-list-md text-xs-center>
                <div class="body-header">
                    业绩
                </div>

                <v-layout row align-center>
                        <v-flex xs6>
                            主账号：正崎代理(上海)有限公司
                            &nbsp;&nbsp;
                            <v-btn color="s-primary" class="ml-0" @click="showEdit = true">
                                <v-icon dark>edit</v-icon>修改资料
                            </v-btn>
                        </v-flex>
                        <v-flex xs4>
                            <v-card-text class="pa-0">KOOA客服：武勇 1234567890</v-card-text>
                        </v-flex>
                        <v-flex xs2>
                            负责人：陈大文
                        </v-flex>
                    </v-layout>

                <div class="text-xs-right date-container">
                    <span class="px-2">从</span>
                    <v-menu ref="menu" :close-on-content-click="false" v-model="menu" :nudge-right="40"
                        :return-value.sync="dateFm" lazy transition="scale-transition" offset-y>
                        <v-text-field slot="activator" v-model="dateFm" prepend-icon="event" readonly></v-text-field>
                        <v-date-picker v-model="dateFm" @input="$refs.menu.save(dateFm)"></v-date-picker>
                    </v-menu>
                    </v-date-picker>
                    <span class="px-2">至</span>
                    <v-menu ref="menu1" :close-on-content-click="false" v-model="menu1" :nudge-right="40"
                        :return-value.sync="dateTo" lazy transition="scale-transition" offset-y>
                        <v-text-field slot="activator" v-model="dateTo" prepend-icon="event" readonly></v-text-field>
                        <v-date-picker v-model="dateTo" @input="$refs.menu1.save(dateTo)"></v-date-picker>
                    </v-menu>

                    <div>
                        <v-select :items="month" label="月份"></v-select>
                    </div>

                </div>

                <v-layout align-center>
                    <v-data-table :headers="theader" :items="tdata" hide-actions item-key="a" expand class="elevation-1 s-table"
                        ref="dTable">

                        <template slot="items" slot-scope="props">
                            <tr @click="props.expanded = !props.expanded">

                                <td class="text-xs-left" ref="td1">
                                    <v-icon v-if="props.expanded" xs class="item-arrow">
                                        keyboard_arrow_down
                                    </v-icon>

                                    <v-icon v-if="!props.expanded" xs class="item-arrow">
                                        keyboard_arrow_right
                                    </v-icon>

                                    {{ props.item.a }}
                                </td>
                                <td class="text-xs-right">
                                    {{ props.item.b }}
                                </td>
                                <td class="text-xs-right sp-color">
                                    {{ props.item.b }}
                                </td>
                                <td class="text-xs-right">
                                    {{ props.item.d }}
                                </td>
                                <td class="text-xs-right sp-color">

                                    <svg width="20" height="20" viewBox="0 0 20 20">
                                        <circle r="10" cx="10" cy="10" stroke="#655" stroke-width="20"
                                            :stroke-dasharray="props.item.pie"></circle>
                                    </svg>

                                    <span>
                                        {{ props.item.e }}%
                                    </span>
                                </td>
                                <td class="text-xs-right">
                                    {{ props.item.f }}
                                </td>
                                <td class="text-xs-right">
                                    {{ props.item.g }}
                                </td>
                                <td class="text-xs-right sp-color">
                                    {{ props.item.h }}
                                </td>
                                <td class="text-xs-right sp-color">
                                    {{ props.item.i }}%
                                </td>
                                <td class="text-xs-right">
                                    {{ props.item.j }}%
                                </td>
                                <td class="text-xs-right">
                                    ${{ props.item.k }}
                                </td>
                                <td class="text-xs-center">
                                    <v-icon v-if="props.item.l" md class="mr-2" color="red" title="停止">
                                        cancel
                                    </v-icon>

                                    <v-icon v-if="!props.item.l" md class="mr-2" color="light-green" title="开始">
                                        lens
                                    </v-icon>
                                </td>
                            </tr>
                        </template>

                        <template slot="expand" slot-scope="props">
                            <v-container grid-list-md text-xs-left>

                                <template v-if="props.item.children.length">
                                    <v-layout row wrap>
                                        <template xs12 v-for="(subItem, subIdx) in props.item.children" :key="subIdx">
                                            <v-flex xs2 offset-xs1>
                                                {{subItem.a}}
                                            </v-flex>
                                            <v-flex xs2>
                                                {{subItem.b}}
                                            </v-flex>
                                            <v-flex xs1>
                                                <span class="sub-item-sp">
                                                    {{subItem.c}}
                                                </span>

                                            </v-flex>
                                            <v-flex xs1>
                                                {{subItem.d}}
                                            </v-flex>

                                            <v-flex xs1>
                                                <span class="sub-item-sp">
                                                    {{subItem.e}}
                                                </span>
                                            </v-flex>

                                            <v-flex xs1>
                                                {{subItem.f}}
                                            </v-flex>

                                            <v-flex xs1>
                                                <span class="sub-item-sp">
                                                    {{subItem.g}}
                                                </span>
                                            </v-flex>
                                            <v-flex xs2>
                                                {{subItem.h}}
                                            </v-flex>
                                        </template>

                                        <!-- 汇总 -->
                                        <v-flex xs7 offset-xs5 class="line"></v-flex>
                                        <!-- <div class="sub-item-total"> -->
                                        <v-flex xs1 offset-xs5>
                                            <span class="sub-item-sp">
                                                {{props.item.childTotal.a}}
                                            </span>

                                        </v-flex>
                                        <v-flex xs1>
                                            {{props.item.childTotal.b}}
                                        </v-flex>

                                        <v-flex xs1>
                                            <span class="sub-item-sp">
                                                {{props.item.childTotal.c}}
                                            </span>
                                        </v-flex>

                                        <v-flex xs1>
                                            {{props.item.childTotal.d}}
                                        </v-flex>

                                        <v-flex xs1>
                                            <span class="sub-item-sp">
                                                {{props.item.childTotal.e}}
                                            </span>
                                        </v-flex>
                                        <v-flex xs2>
                                            {{props.item.childTotal.f}}
                                        </v-flex>
                                        <!-- </div> -->

                                    </v-layout>
                                    <!-- </v-layout> -->
                                </template>

                                <template v-if="!props.item.children.length">
                                    <div class="text-xs-center">
                                        暂无数据
                                    </div>
                                </template>
                            </v-container>
                        </template>

                    </v-data-table>
                </v-layout>
            </v-container>

        </v-app>
    </div>

    <script src="./js/vue.js"></script>
    <script src="./js/vuetify.js"></script>
    <script>
        new Vue({
            el: '#app',

            methods: {
                createPie() {}
            },

            data() {
                return {
                    dateFm: null,
                    dateTo: null,
                    menu: false,
                    menu1: false,

                    mounted() {

                        for (let i = 0; i < this.tdata.length; i += 1) {
                            const item = this.tdata[i];

                            // item['pie'] = (item['e'] / 100 * 72) + ' 100'

                            this.$set(this.$refs.dTable.expanded, item.a, true)
                        }
                    },

                    // methods:{
                    //     calcPiePer(value){
                    //         return (value / 100 * 72) + ' 100';
                    //     }
                    // },

                    month: ['1月', '2月', '3月', '4月', '5月', '6月',
                        '7月', '8月', '9月', '10月', '11月', '12月'
                    ],

                    theader: [{
                            text: '销售',
                            align: 'left',
                            value: 'a',
                            sortable: false,
                        },
                        {
                            text: '销售目标',
                            align: 'right',
                            value: 'b',
                            sortable: false,
                        },
                        {
                            text: '完成量',
                            align: 'right',
                            value: 'c',
                            sortable: true,
                        },
                        {
                            text: '未完成量',
                            align: 'right',
                            value: 'd',
                            sortable: true,
                        },
                        {
                            text: '完成比例',
                            align: 'center',
                            value: 'e',
                            sortable: true,
                        },
                        {
                            text: '医生量指标',
                            align: 'right',
                            value: 'f',
                            sortable: false,
                        },
                        {
                            text: '完成量',
                            align: 'right',
                            value: 'g',
                            sortable: false,
                        },
                        {
                            text: '未完成量',
                            align: 'right',
                            value: 'h',
                            sortable: false,
                        },
                        {
                            text: '%',
                            align: 'right',
                            value: 'i',
                            sortable: false,
                        },

                        {
                            text: '提成%',
                            align: 'right',
                            value: 'j',
                            sortable: false,
                        },

                        {
                            text: '提成$',
                            align: 'right',
                            value: 'k',
                            sortable: false,
                        },
                        {
                            text: '状态',
                            align: 'center',
                            value: 'l',
                            sortable: false,
                        },
                    ],

                    tdata: [{
                            a: '王成',
                            b: 5000,
                            c: 3751,
                            d: 1249,
                            e: 72,
                            f: 300,
                            g: 150,
                            h: 150,
                            i: 50,
                            j: 20,
                            k: 13500,
                            l: false,
                            pie: '44 100', //左边是62 * e的百分比, 笔的总宽度是62px

                            children: [{
                                    a: '李文',
                                    b: 136521566145,
                                    c: 12132,
                                    d: 1111,
                                    e: 1355454,
                                    f: 15,
                                    g: 1225,
                                    h: 123
                                },
                                {
                                    a: '李三',
                                    b: 1365215661,
                                    c: 12132,
                                    d: 1111,
                                    e: 1355454,
                                    f: 15,
                                    g: 1225,
                                    h: 123
                                }
                            ],

                            childTotal: {
                                a: 12132,
                                b: 1111,
                                c: 1355454,
                                d: 15,
                                e: 1225,
                                f: 1111
                            }
                        },
                        {
                            a: '王李',
                            b: 5000,
                            c: 3751,
                            d: 1249,
                            e: 72,
                            f: 300,
                            g: 150,
                            h: 150,
                            i: 50,
                            j: 20,
                            k: 13500,
                            l: true,
                            pie: '44 100', //左边是62 * e的百分比, 笔的总宽度是62px

                            children: [

                            ]
                        },
                    ]
                };
            }
        })
    </script>
</body>

</html>